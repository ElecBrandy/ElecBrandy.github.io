<!DOCTYPE html>
<html lang="en-us" dir="ltr">
<head>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css">
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '\\(', right: '\\)', display: false},
                {left: '$', right: '$', display: false}
            ]
        });"></script>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<link rel="stylesheet" href="/css/reset.css">
<title>[42cursus] minishell | home</title>

      <link rel="stylesheet" href="/css/main.min.0ce01787cd4bc0759f98b56377f962e02878ce8fb515cc49af5cb83db6a3edfc.css" integrity="sha256-DOAXh81LwHWfmLVjd/li4Ch4zo&#43;1FcxJr1y4Pbaj7fw=" crossorigin="anonymous">
      <link rel="stylesheet" href="/css/min700.min.c55885430d625813d1a6770ef6712b8534781fdd318699edd1bb9c6f62907507.css" integrity="sha256-xViFQw1iWBPRpncO9nErhTR4H90xhpnt0bucb2KQdQc=" crossorigin="anonymous">



<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Fira+Code&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic+Coding:wght@400;700&display=swap" rel="stylesheet">



<script async src="https://www.googletagmanager.com/gtag/js?id=G-ZL1NP5K5CJ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-ZL1NP5K5CJ');
</script>


</head>
<body>
    <header class="main-header">
	<nav>
	  <li><a href="/">/home</a></li>
	  <li><a href="/tags">/tags</a></li>
	  <li><a href="/about">/about</a></li>
	  <li id="theme-toggle" style="cursor: pointer;">/todark</li>
	</nav>
  </header>
  
  <script>
	document.addEventListener('DOMContentLoaded', function() {
	  const themeToggle = document.getElementById('theme-toggle');
	  
	  
	  let currentTheme = localStorage.getItem('theme') || 'light';
  
	  
	  document.body.setAttribute('data-theme', currentTheme);
	  themeToggle.textContent = currentTheme === 'dark' ? '/tolight' : '/todark';
  
	  
	  function toggleTheme() {
		
		const newTheme = document.body.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
  
		
		document.body.setAttribute('data-theme', newTheme);
  
		
		localStorage.setItem('theme', newTheme);
  
		
		themeToggle.textContent = newTheme === 'dark' ? '/tolight' : '/todark';
	  }
  
	  
	  themeToggle.addEventListener('click', toggleTheme);
	});
  </script>
  
    
  <aside class="toc">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#2-minishell-명세서">2. minishell 명세서</a></li>
    <li><a href="#3-개념-정리">3. 개념 정리</a>
      <ul>
        <li><a href="#3-1-shell">3-1. Shell</a></li>
        <li><a href="#3-2-환경-변수">3-2. 환경 변수</a></li>
        <li><a href="#3-3-built-in-함수">3-3. built-in 함수</a></li>
      </ul>
    </li>
    <li><a href="#4-mandatory">4. Mandatory</a>
      <ul>
        <li><a href="#4-1-built-in-구현">4-1. built-in 구현</a></li>
      </ul>
    </li>
    <li><a href="#5-reference">5. Reference</a></li>
  </ul>
</nav>
  </aside>
  <div class="featured-container">
    
      <div class="featured-image">
        <img src="http://t1.daumcdn.net/cfile/126C5A10B091DEEF0B" alt="Featured Image for [42cursus] minishell">
      </div>
    
    <div class="overlay-text">
      <small>2024.06.06</small>
      <div class="singleTitle">[42cursus] minishell</div>
    </div>
  </div>
  <div class="series">
  <details>
    <summary>📚 /42cursus</summary>
    <ul>
      
      
      
      <li>-<a href="https://elecbrandy.github.io/posts/42cursus/circle_0/libft/">libft</a></li>
      
      <li>-<a href="https://elecbrandy.github.io/posts/42cursus/circle_1/ft_printf/">ft_printf</a></li>
      
      <li>-<a href="https://elecbrandy.github.io/posts/42cursus/circle_1/get_next_line/">get_next_line</a></li>
      
      <li>-<a href="https://elecbrandy.github.io/posts/42cursus/circle_1/born2beroot/">born2beroot</a></li>
      
      <li>-<a href="https://elecbrandy.github.io/posts/42cursus/circle_2/pipex/">pipex</a></li>
      
      <li>-<a href="https://elecbrandy.github.io/posts/42cursus/circle_2/fdf/">fdf</a></li>
      
      <li>-<a href="https://elecbrandy.github.io/posts/42cursus/circle_2/push_swap/">push_swap</a></li>
      
      <li>-<a href="https://elecbrandy.github.io/posts/42cursus/circle_3/minishell/">minishell</a></li>
      
      <li>-<a href="https://elecbrandy.github.io/posts/42cursus/circle_3/philosopher/">philosopher</a></li>
      
      <li>-<a href="https://elecbrandy.github.io/posts/42cursus/circle_4/netpractice/">netpractice</a></li>
      
    </ul>
  </details>
</div>

<p>draft = true</p>
<br>
<h1 id="1-소개">1. 소개</h1>
<hr>
<blockquote>
<p>As beautiful as a shell</p>
</blockquote>
<p>42서울 본과정 입과 후 여덟번째로 수행한 과제로, 작은 크기의 shell을 구현하는 과제이다. 우리는 이제 간단한 빌트인 함수부터 여러 명령어를 수행할 수 있는 <strong>minishell</strong>을 만들어야 한다. 너무 큰 shell을 만들기 위해서 노력하다가 블랙홀에 빠지지 않게 조심하자!</p>
<br>
<br>
<h2 id="2-minishell-명세서">2. minishell 명세서</h2>
<hr>
<ul>
<li><strong>PROGRAM NAME</strong>
<ul>
<li><code>minishell</code></li>
</ul>
</li>
<li><strong>PARAMETER</strong>
<ul>
<li><code>commands...</code></li>
</ul>
</li>
<li><strong>DESCRIPTION</strong>
<ol>
<li>
<p><strong>명령 대기 중 프롬프트 표시</strong>: 새 명령을 기다릴 때 프롬프트를 표시해야함!</p>
</li>
<li>
<p><strong>작업 이력 관리</strong>: 이전 명령의 작업 이력을 관리할 수 있어야 함!</p>
</li>
<li>
<p><strong>실행 파일 검색 및 실행</strong>: <code>PATH</code> 변수를 기반으로 올바른 실행 파일을 검색하고 실행해야하고, 상대 경로나 절대 경로를 사용할 수 있어야 한다.</p>
</li>
<li>
<p><strong>신호 처리</strong>: <strong>전역 변수 사용</strong>은 오로지 하나!</p>
</li>
<li>
<p><strong>해석하지 말아야 할 항목</strong>: 닫히지 않은 인용부호(따옴표)나 주제와 관련 없는 특수 문자(<code>\</code>, <code>;</code>)는 해석하지 않아야 함&hellip;</p>
</li>
<li>
<p><strong>따옴표 처리</strong>:<br>
싱글 쿼트 (<code>'</code>): 인용된 시퀀스에서 메타문자가 해석되지 않도록 해야 함<br>
더블 쿼트 (<code>&quot;</code>): <code>$</code>를 제외한 메타문자가 해석되지 않도록 해야 함</p>
</li>
<li>
<p><strong>리디렉션 구현</strong>:<br>
<code>&lt;</code>: 입력을 리디렉션<br>
<code>&gt;</code>: 출력을 리디렉션<br>
<code>&lt;&lt;</code>: 구분자를 지정한 다음, 구분자를 포함한 줄을 읽을 때까지 입력을 받아야 하고, (이 작업은 이력에 기록되지 않아야 한다.)<br>
<code>&gt;&gt;</code>: 출력을 추가 모드로 리디렉션</p>
</li>
<li>
<p><strong>파이프라인 구현</strong>: <code>|</code>로 각 명령의 출력을 다음 명령의 입력으로 연결해야 함.</p>
</li>
<li>
<p><strong>환경 변수 처리</strong>: <code>$</code>로 시작하는 문자열은 해당 값으로 확장되어야 함.</p>
</li>
<li>
<p><strong>특수 변수 처리</strong>: <code>$?</code>: 최근에 실행된 포그라운드 파이프라인의 종료 상태로 확장되어야 함.</p>
</li>
<li>
<p><strong>특수 키 처리</strong>:<br>
<code>Ctrl-C</code>: 새로운 줄에 새 프롬프트를 표시<br>
<code>Ctrl-D</code>: 셸을 종료<br>
<code>Ctrl-\</code>: 아무런 동작도 하지 않음</p>
</li>
<li>
<p><strong>built-in 구현</strong>:<br>
<code>echo</code>: 옵션 <code>-n</code> 지원<br>
<code>cd</code>: 상대 경로 또는 절대 경로만 지원<br>
<code>pwd</code>: 옵션 없이 지원<br>
<code>export</code>: 옵션 없이 지원<br>
<code>unset</code>: 옵션 없이 지원<br>
<code>env</code>: 옵션이나 인수 없이 지원<br>
<code>exit</code>: 옵션 없이 지원</p>
</li>
</ol>
</li>
</ul>
<br>
<br>
<h2 id="3-개념-정리">3. 개념 정리</h2>
<hr>
<h3 id="3-1-shell">3-1. Shell</h3>
<p><strong>Shell</strong>은 사용자가 OS와 상호작용할 수 있도록 해주는 프로그램이다. 사용자가 명령어를 입력하면 이를 OS가 이해할 수 있도록 해석하고, 그에 따른 작업을 수행한다. Shell은 커맨드 라인 인터페이스를 제공하며, 사용자의 명령어를 <strong>읽고-해석하고-실행하고-결과를 출력</strong>한다.</p>
<p>shell에는 Bash, Zsh 등등 다양한 종류가 존재한다. 이때 Bash는 가장 널리 사용되는 shell이고, 클러스터 맥에 설치되어있는 기본 shell 이기도 하다. bash의 동작을 잘 뜯어보면서 과제를 수행해보자.</p>
<br>
<h3 id="3-2-환경-변수">3-2. 환경 변수</h3>
<p><strong>환경 변수</strong>는 운영 체제에서 프로그램이 실행되는 동안 사용할 수 있는 변수이다. 이 변수들은 시스템 전체에 걸쳐 정보를 전달하거나 설정을 저장하는 데 사용된다. 환경 변수는 주로 시스템 경로, 사용자 정보, 설정 정보 등을 담고 있다.</p>
<br>
<h3 id="3-3-built-in-함수">3-3. built-in 함수</h3>
<p>과제 상 구현해야하는 <strong>built-in</strong> 함수의 정체는 무엇일까?</p>
<p>Shell에서 <strong>built-in</strong> 함수란 Shell 자체에 내장된 명령어 또는 기능을 의미한다. 이러한 함수는 별도의 외부 프로그램을 실행하지 않고, Shell 자체에서 직접 수행된다. 이는 특정 작업을 보다 빠르게 수행할 수 있게 하며, Shell 스크립트에서 자주 사용되는 기본적인 작업들을 처리하는 데 유용하다.</p>
<p>이 말은 즉슨, 해당 함수들은 환경변수 PATH가 변경되거나 망가지는 일이 있어도 정상적으로 동작해야한다는 점! 또한 Shell 자체에서 실행한다는 점을 곱씹으면, built-in 함수를 실행할 때는 fork를 사용할 필요 없다는 것도 알 수 있다.</p>
<br>
<br>
<h2 id="4-mandatory">4. Mandatory</h2>
<hr>
<p>이번 과제는 2인이 협동해야하는 팀 과제이다! 주로 역할분배는 <strong>명령어 파싱부</strong>와 <strong>실행부</strong>로 구분하곤 한다.</p>
<p>명령어 파싱의 경우 bonus를 고려하지 않으면 주로 연결리스트로 관리를 하고, bonus를 고려할 경우 트리형태로 관리한다. 실행부의 경우 이전 과제인 <strong>pipex</strong>와 사실상 유사하기 때문에 익숙한 작업이 주를 이룬다.</p>
<p>우리 팀의 경우 내가 <code>실행부 + 빌트인함수</code>를 맡았고, 함께한 팀원분이 <code>파싱부 + here_doc 등</code>을 맡았다.</p>
<p>이에 따라, 이번 과제 정리는 내가 담당한 빌트인 함수만 주로 다루어보고자 한다. (실행부는 <strong>pipex</strong>와 유사). 코드를 실제로 나열하기보다는 각 함수들이 어떠한 특징을 가지고 있는지 알아보자! 함수들의 작동은 모두 bash shell을 기준으로 작동을 확인해보자.</p>
<br>
<h3 id="4-1-built-in-구현">4-1. built-in 구현</h3>
<h4 id="ft_cd">ft_cd</h4>
<ul>
<li>
<p><code>cd</code></p>
<ul>
<li><code>HOME</code> 환경 변수를 찾아 해당 경로로 이동</li>
<li><code>HOME</code>이 없으면 에러 반환</li>
</ul>
</li>
<li>
<p><code>cd path</code></p>
<ul>
<li><code>path</code>가 존재하는지 검사 후 이동.</li>
<li>이동에 성공한 경우 환경변수 <code>PWD</code>와 <code>OLDPWD</code>를 갱신</li>
<li>실패 시 에러 반환</li>
</ul>
</li>
<li>
<p><code>cd ~</code></p>
<ul>
<li><code>HOME</code>으로 이동</li>
<li>bash shell 상에서 <code>HOME</code> 환경변수를 제거한 상태에서도 작동하는 것을 확인했기에, 이 명령 작동이 환경변수에 얽메이는 것이 아니라고 판단했음</li>
</ul>
</li>
<li>
<p><code>cd -</code></p>
<ul>
<li>이전 디렉토리로 이동</li>
</ul>
</li>
</ul>
<br>
<h4 id="ft_echo">ft_echo</h4>
<ul>
<li>
<p><code>echo</code></p>
<ul>
<li>인자가 없으면 개행(<code>\n</code>) 출력</li>
</ul>
</li>
<li>
<p><code>echo text</code></p>
<ul>
<li>입력된 문자열을 그대로 출력하고 개행(<code>\n</code>) 추가</li>
</ul>
</li>
<li>
<p><code>echo -n text</code></p>
<ul>
<li><code>-n</code> 옵션을 감지하면 개행 없이 출력</li>
</ul>
</li>
<li>
<p><code>echo -n -n -n text</code></p>
<ul>
<li><code>-n</code>이 여러 개 있어도 하나의 옵션으로 처리하여 개행 없이 출력</li>
</ul>
</li>
<li>
<p><code>echo -nnn text</code></p>
<ul>
<li><code>n</code>이 여러 개 있어도 하나의 옵션으로 처리하여 개행 없이 출력</li>
</ul>
</li>
<li>
<p><code>echo -nnNn text</code></p>
<ul>
<li>이때는 옵션이 무효되며, <code>-nnNn text\n</code> 출력</li>
</ul>
</li>
<li>
<p><code>echo -n text -n more_text</code></p>
<ul>
<li>첫 번째 <code>-n</code>은 옵션으로 인식하고 이후 <code>-n</code>은 일반 문자열로 출력</li>
</ul>
</li>
</ul>
<br>
<h4 id="ft_env">ft_env</h4>
<ul>
<li>
<p><code>env</code></p>
<ul>
<li>인자가 없으면 모든 환경 변수를 출력</li>
<li><code>key=value</code> 형식으로 출력되며, <code>=</code>가 포함되지 않은 변수는 출력되지 않음</li>
<li>환경 변수가 없을 경우 에러 출력</li>
</ul>
</li>
<li>
<p><code>env arg</code></p>
<ul>
<li>인자가 있으면 <code>env: too many arguments</code> 에러 출력</li>
</ul>
</li>
</ul>
<br>
<h4 id="ft_exit">ft_exit</h4>
<ul>
<li>
<p><code>exit</code></p>
<ul>
<li>인자가 없으면 기존 종료 코드(<strong>전역 변수</strong>)로 쉘을 종료</li>
</ul>
</li>
<li>
<p><code>exit num</code></p>
<ul>
<li><code>num</code>이 숫자면 <code>num % 256</code> 값으로 쉘 종료</li>
<li><code>num</code>이 숫자가 아니면 <code>&quot;exit: numeric argument required&quot;</code> 에러 출력 후 종료 (코드 <code>255</code>)</li>
</ul>
</li>
<li>
<p><code>exit num1 num2 ...</code></p>
<ul>
<li>인자가 2개 이상이면 <code>&quot;exit: too many arguments&quot;</code> 에러 출력 후 쉘을 종료하지 않음</li>
</ul>
</li>
<li>
<p><code>malloc</code> 오류 발생 시</p>
<ul>
<li><code>&quot;malloc error&quot;</code> 출력 후 종료 (코드 <code>12</code>)</li>
</ul>
</li>
<li>
<p>예제 케이스</p>
<table>
  <thead>
      <tr>
          <th>입력 값</th>
          <th>반환 값</th>
          <th>비고</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>&quot; 12342  241 &quot;</code></td>
          <td><code>1</code></td>
          <td>공백 포함 여러 숫자는 허용되지 않음</td>
      </tr>
      <tr>
          <td><code>&quot;   3  &quot;</code></td>
          <td><code>0</code></td>
          <td>유효한 숫자</td>
      </tr>
      <tr>
          <td><code>&quot;  3a  &quot;</code></td>
          <td><code>1</code></td>
          <td>숫자 뒤에 문자가 포함되면 오류</td>
      </tr>
      <tr>
          <td><code>&quot;  3 4  &quot;</code></td>
          <td><code>1</code></td>
          <td>여러 개의 숫자가 포함되면 오류</td>
      </tr>
      <tr>
          <td><code>&quot;  3 4a  &quot;</code></td>
          <td><code>1</code></td>
          <td>숫자 + 문자 조합은 오류</td>
      </tr>
      <tr>
          <td><code>&quot;  3 4 5  &quot;</code></td>
          <td><code>1</code></td>
          <td>여러 개의 숫자는 허용되지 않음</td>
      </tr>
      <tr>
          <td><code>&quot;lkj1234214&quot;</code></td>
          <td><code>1</code></td>
          <td>숫자로 시작하지 않으면 오류</td>
      </tr>
  </tbody>
</table>
</li>
</ul>
<br>
<h4 id="ft_export">ft_export</h4>
<ul>
<li>
<p><code>export</code></p>
<ul>
<li>인자가 없으면 환경 변수를 정렬하여 <code>declare -x key=&quot;value&quot;</code> 형식으로 출력</li>
<li>환경 변수가 없으면 <code>&quot;No such file or directory&quot;</code> 에러 출력</li>
</ul>
</li>
<li>
<p><code>export key=value</code></p>
<ul>
<li><code>key</code>가 유효하면 환경 변수 추가 또는 갱신</li>
<li><code>key</code>가 유효하지 않으면 <code>&quot;not a valid identifier&quot;</code> 에러 출력</li>
</ul>
</li>
<li>
<p><code>export key</code></p>
<ul>
<li>값 없이 <code>key</code>만 입력하면 빈 값(<code>&quot;&quot;</code>)을 가진 환경 변수로 등록</li>
</ul>
</li>
<li>
<p><code>export key=value key2=value2 ...</code></p>
<ul>
<li>여러 개의 환경 변수를 한 번에 추가 가능</li>
</ul>
</li>
</ul>
<br>
<h4 id="ft_pwd">ft_pwd</h4>
<ul>
<li>현재 작업 디렉토리를 출력 (<code>getcwd()</code> 사용)</li>
<li><code>getcwd()</code>가 실패하면 <code>&quot;Failed to get current directory.&quot;</code> 에러 출력 후 <code>g_signal_error = 1</code> 설정</li>
</ul>
<br>
<h4 id="ft_unset">ft_unset</h4>
<ul>
<li>
<p><code>unset key</code></p>
<ul>
<li>환경 변수에서 <code>key</code>를 삭제</li>
<li><code>key</code>가 존재하지 않아도 에러 없이 넘어감</li>
</ul>
</li>
<li>
<p><code>unset key1 key2 ...</code></p>
<ul>
<li>여러 개의 환경 변수를 한 번에 삭제 가능</li>
</ul>
</li>
<li>
<p><code>unset</code> (인자 없음)</p>
<ul>
<li>아무 동작도 하지 않음</li>
</ul>
</li>
<li>
<p>유효하지 않은 <code>key</code> 입력 시</p>
<ul>
<li><code>&quot;unset: 'key': not a valid identifier&quot;</code> 에러 출력</li>
</ul>
</li>
</ul>
<br>
<h2 id="5-reference">5. Reference</h2>
<hr>
<ul>
<li><a href="https://www.freebsd.org">https://www.freebsd.org</a></li>
</ul>
<br>
<br>


    

<script src="https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js"></script>
<script>addBackToTop({
  diameter: 40,
  backgroundColor: 'rgb(255, 83, 176)',
  textColor: '#fff'
})</script>

</body>
</html>
